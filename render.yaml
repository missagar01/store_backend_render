services:
  - type: web
    name: store-backend-render
    env: node
    plan: starter
    autoDeploy: true

    buildCommand: npm install
    startCommand: node src/server.js

    # Keep health check independent of DB so deploys aren't blocked
    healthCheckPath: /docs
    healthCheckTimeout: 10

    # Environment configuration
    envVars:
      - key: NODE_ENV
        value: production
      # Prefer setting a fixed Node version via package.json "engines",
      # but you can pin via env too if needed
      - key: NODE_VERSION
        value: "22"
      # Secrets set in the Render dashboard (not committed)
      - key: ORACLE_USER
        sync: false
      - key: ORACLE_PASSWORD
        sync: false
      - key: ORACLE_CONNECT_STRING
        sync: false
      # Compatibility: some environments use ORACLE_CONNECTION_STRING
      - key: ORACLE_CONNECTION_STRING
        sync: false
      # Longer client timeouts for Oracle connectivity (read in your code)
      - key: ORACLE_CONNECT_TIMEOUT_MS
        value: "60000"
      - key: ORACLE_QUEUE_TIMEOUT_MS
        value: "60000"
      # Supabase (server-side)
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      # Optional: if your code expects these
      - key: SUPABASE_ANON_KEY
        sync: false
      - key: SUPABASE_JWT_SECRET
        sync: false
      # Google Sheets (use a single JSON secret for the service account)
      - key: GOOGLE_SERVICE_ACCOUNT_JSON
        sync: false
      - key: GOOGLE_SHEETS_SPREADSHEET_ID
        sync: false
